webpackJsonp([14],{ufIM:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("1onU"),r=a("gyMJ"),l=a("0xDb"),o={components:{pagination:s.a},data:function(){return{tableData:[],tableLoading:!0,listQuery:{pageNum:1,pageSize:20},total:0,index:0,drinkDialog:{title:"",type:"",show:!1},studentForm:{},gradeData:[],subjectList:[],studentRules:{studentName:[{required:!0,message:"此项为必填项",trigger:"blur"}],phone:[{required:!0,message:"此项为必填项",trigger:"blur"}],gradeId:[{required:!0,message:"此项为必填项",trigger:"blur"}],typeId:[{required:!0,message:"此项为必填项",trigger:"blur"}],subjectIds:[{required:!0,message:"此项为必填项",trigger:"blur"}]}}},filters:{format:function(t){var e=new Date(t);function a(t){return t<10?"0"+t:t}return e.getFullYear()+"-"+a(e.getMonth()+1)+"-"+a(e.getDate())+" "+a(e.getHours())+":"+a(e.getMinutes())+":"+a(e.getSeconds())}},computed:{num:function(t){var e=this.listQuery;return(e.pageNum-1)*e.pageSize+1}},methods:{getGrade:function(){var t=this;Object(r.g)().then(function(e){t.gradeData=e.data.data})},formatSub:function(t){for(var e="",a=t.length,s=0;s<a;s++)e+=t[s].subjectName+(s===t.length-1?"":"/");return e},getData:function(){var t=this;Object(r.x)(this.listQuery).then(function(e){t.tableLoading=!1,e.data.data.forEach(function(e){e.subjectIds=t.formatSub(e.subjectIds)}),t.tableData=e.data.data,t.total=parseInt(e.data.total)})},checkDetail:function(t){var e=this;this.$refs.studentForm&&this.$refs.studentForm.resetFields(),this.drinkDialog={type:"UPDATE",show:!0,title:"修改"},Object(r.w)({id:t._id}).then(function(a){e.getSubjectList(t.gradeId),e.$nextTick(function(){e.studentForm=a.data.data,e.studentForm.subjectIds=e.studentForm.subjectIds.map(function(t){return t._id})})})},check:function(){var t=this,e={};this.subjectList.forEach(function(t){e[t._id]=t}),this.studentForm.subjectIds=this.studentForm.subjectIds.map(function(t){return e[t]}),Object(r.u)(this.studentForm).then(function(){t.getData(),t.drinkDialog.show=!1})},handleDelete:function(t){var e=this;Object(l.a)(this,function(){Object(r.v)({id:t._id}).then(function(){e.getData()})})},getSubjectList:function(t){var e=this;this.studentForm.subjectIds=[],Object(r.A)({gradeId:t}).then(function(t){e.subjectList=t.data.data})},handleAdd:function(){this.drinkDialog={type:"ADD",show:!0,title:"新增"},this.$refs.studentForm&&this.$refs.studentForm.resetFields()},save:function(){var t=this;"ADD"===this.drinkDialog.type&&this.$refs.studentForm.validate(function(e){if(e){var a={};t.subjectList.forEach(function(t){a[t._id]=t}),t.studentForm.subjectIds=t.studentForm.subjectIds.map(function(t){return a[t]}),Object(r.t)(t.studentForm).then(function(e){t.getData(),t.drinkDialog.show=!1})}})}},created:function(){this.getData(),this.getGrade()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{attrs:{size:"medium",type:"primary",icon:"el-icon-edit"},on:{click:t.handleAdd}},[t._v("添加")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{size:"medium",data:t.tableData,border:"",stripe:!0}},[a("el-table-column",{attrs:{align:"center",type:"index",index:t.num,label:"序号",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"studentName",align:"center",label:"家长姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"phone",align:"center","show-overflow-tooltip":"",label:"手机号码"}}),t._v(" "),a("el-table-column",{attrs:{prop:"gradeName",align:"center",label:"子女年级"}}),t._v(" "),a("el-table-column",{attrs:{prop:"subjectIds",align:"center","show-overflow-tooltip":"",label:"所补科目"}}),t._v(" "),a("el-table-column",{attrs:{prop:"expectFee",align:"center","show-overflow-tooltip":"",label:"期望课费"}}),t._v(" "),a("el-table-column",{attrs:{prop:"school","show-overflow-tooltip":"",align:"center",label:"所在学校"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime","show-overflow-tooltip":"",align:"center",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("format")(e.row.createTime))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"remark","show-overflow-tooltip":"",align:"center",label:"子女情况"}}),t._v(" "),a("el-table-column",{attrs:{prop:"checkStatus",align:"center","show-overflow-tooltip":"",width:"100px",label:"审核状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.checkStatus?a("el-tag",{attrs:{size:"medium",type:"danger"}},[t._v("未通过")]):a("el-tag",{attrs:{size:"medium",type:"success"}},[t._v("已通过")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"160","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.checkDetail(e.row)}}},[t._v("审核")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:t.drinkDialog.title,visible:t.drinkDialog.show,width:"500px"},on:{"update:visible":function(e){t.$set(t.drinkDialog,"show",e)}}},[a("el-form",{ref:"studentForm",attrs:{size:"medium",rules:t.studentRules,model:t.studentForm,"label-position":"left","label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"家长姓名：",prop:"studentName"}},[a("el-input",{attrs:{placeholder:"请输入家长姓名"},model:{value:t.studentForm.studentName,callback:function(e){t.$set(t.studentForm,"studentName",e)},expression:"studentForm.studentName"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"手机号码：",prop:"phone"}},[a("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:t.studentForm.phone,callback:function(e){t.$set(t.studentForm,"phone",e)},expression:"studentForm.phone"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"子女年级：",prop:"gradeId"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.getSubjectList},model:{value:t.studentForm.gradeId,callback:function(e){t.$set(t.studentForm,"gradeId",e)},expression:"studentForm.gradeId"}},t._l(t.gradeData,function(t){return a("el-option",{key:t._id,attrs:{label:t.gradeName,value:t._id}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"所补科目：",prop:"subjectIds"}},[a("el-select",{attrs:{disabled:!t.studentForm.gradeId,multiple:"",placeholder:t.studentForm.gradeId?"请选择":"请先选择子女年级"},model:{value:t.studentForm.subjectIds,callback:function(e){t.$set(t.studentForm,"subjectIds",e)},expression:"studentForm.subjectIds"}},t._l(t.subjectList,function(t,e){return a("el-option",{key:e,attrs:{label:t.subjectName,value:t._id}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"期望课费：",prop:"expectFee"}},[a("el-input",{attrs:{placeholder:"请输入期望课费"},model:{value:t.studentForm.expectFee,callback:function(e){t.$set(t.studentForm,"expectFee",e)},expression:"studentForm.expectFee"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"所在学校：",prop:"school"}},[a("el-input",{attrs:{placeholder:"请输入所在学校"},model:{value:t.studentForm.school,callback:function(e){t.$set(t.studentForm,"school",e)},expression:"studentForm.school"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"详细地址：",prop:"address"}},[a("el-input",{attrs:{placeholder:"请输入详细地址"},model:{value:t.studentForm.address,callback:function(e){t.$set(t.studentForm,"address",e)},expression:"studentForm.address"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"性别：",prop:"sex"}},[a("el-radio-group",{model:{value:t.studentForm.sex,callback:function(e){t.$set(t.studentForm,"sex",e)},expression:"studentForm.sex"}},[a("el-radio",{attrs:{label:0}},[t._v("未知")]),t._v(" "),a("el-radio",{attrs:{label:1}},[t._v("男")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("女")])],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"子女情况："}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:5},placeholder:"请输入"},model:{value:t.studentForm.remark,callback:function(e){t.$set(t.studentForm,"remark",e)},expression:"studentForm.remark"}})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.drinkDialog.show=!1}}},[t._v("取消")]),t._v(" "),"ADD"==t.drinkDialog.type?a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确认")]):a("el-button",{attrs:{type:"primary"},on:{click:t.check}},[t._v("审核通过")])],1)],1),t._v(" "),a("pagination",{attrs:{total:t.total,listQuery:t.listQuery},on:{getTableData:t.getData}})],1)},staticRenderFns:[]},i=a("vSla")(o,n,!1,null,null,null);e.default=i.exports}});